<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quote</title>
    <link rel="stylesheet" href="./quote.css" />
  </head>

  <body>
    <!-- Customer top bar (screen only) -->
    <header class="topbar no-print">
      <div class="brand">
        <div class="logo-wrap">
          <img
            id="site-logo"
            class="logo"
            src="../assets/elevate-estimator-logo-light.png"
            alt="Company logo"
            crossorigin="anonymous"
          />
          <div id="site-logo-fallback" class="logo-fallback" hidden></div>
        </div>

        <div class="brand-text">
          <div id="site-company-name" class="brand-title">Quote</div>
          <div class="brand-sub">
            <span id="v-quote-code">—</span>
            <span class="dot">•</span>
            <span id="v-quote-status">—</span>
          </div>
        </div>
      </div>

      <div class="actions">
        <button id="download-btn" class="btn" type="button">Download PDF</button>
        <button id="accept-jump-btn" class="btn brand" type="button">Accept &amp; Sign</button>
      </div>
    </header>

    <main class="wrap">
      <div id="banner" class="msg" hidden></div>

      <div id="loading" class="loading">Loading your quote…</div>

      <!-- Quote document (this is what we render + export to PDF) -->
      <section id="quote-page" class="page" hidden>
        <!-- Letterhead -->
        <header class="doc-header avoid-break">
          <div class="letterhead">
            <div class="logo-col">
              <div class="logo-box">
                <img
                  id="doc-logo"
                  src="../assets/elevate-estimator-logo-light.png"
                  alt="Company logo"
                  class="doc-logo"
                  crossorigin="anonymous"
                />
                <div id="doc-logo-initials" class="logo-initials" hidden></div>
              </div>
            </div>

            <div class="company-col">
              <div class="company-row">
                <div class="company-block">
                  <div class="company-name" id="v-company-name"></div>

                  <div class="company-contact" id="v-company-contact">
                    <span id="v-company-addr1"></span>
                    <span id="v-company-addr2"></span>
                    <span id="v-company-phone"></span>
                    <span id="v-company-email"></span>
                    <span id="v-company-web"></span>
                  </div>
                </div>

                <div class="doc-block">
                  <div class="doc-pill">QUOTE</div>
                  <div class="doc-code" id="v-doc-quote-code">—</div>
                </div>
              </div>
            </div>

            <div class="accent-bar full-span"></div>

            <div class="meta-strip full-span">
              <div class="meta-field">
                <span>Quote #</span>
                <div class="meta-val" id="v-meta-quote">—</div>
              </div>

              <div class="meta-field">
                <span>Date</span>
                <div class="meta-val" id="v-meta-date">—</div>
              </div>

              <div class="meta-field">
                <span>Expires</span>
                <div class="meta-val" id="v-meta-expires">—</div>
              </div>

              <div class="meta-field">
                <span>Prepared by</span>
                <div class="meta-val" id="v-meta-prepared">—</div>
              </div>
            </div>
          </div>
        </header>

        <!-- Customer / Job -->
        <section class="grid-2 avoid-break">
          <div class="card">
            <h3>Bill To</h3>
            <div class="contact-block">
              <div class="contact-name" id="v-bill-name">—</div>
              <div class="contact-sub" id="v-bill-sub"></div>
              <div class="contact-addr" id="v-bill-addr"></div>
            </div>
          </div>

          <div class="card">
            <h3>Job Site</h3>
            <div class="contact-block">
              <div class="contact-name" id="v-jobsite">—</div>
              <div class="contact-sub" id="v-jobsite-sub"></div>
            </div>
          </div>
        </section>

        <!-- Items -->
        <section class="card avoid-break">
          <div class="row-between">
            <h3>Items &amp; Pricing</h3>
          </div>

          <div class="items-desktop">
            <div class="table-wrap">
              <table class="items-table" aria-label="Line items">
                <colgroup id="items-colgroup"></colgroup>
                <thead>
                  <tr id="items-head-row"></tr>
                </thead>
                <tbody id="v-item-rows"></tbody>
              </table>
            </div>
          </div>

          <!-- Mobile-friendly item cards -->
          <div class="items-mobile" id="v-item-cards"></div>
        </section>

        <!-- Totals -->
        <section class="card totals avoid-break">
          <h3>Summary</h3>

          <div class="totals-grid">
            <div class="row">
              <div class="label">Subtotal</div>
              <div class="spacer"></div>
              <div class="value"><span class="curr" id="v-curr">$</span><span class="amt" id="v-subtotal">0.00</span></div>
            </div>

            <div class="row">
              <div class="label" id="v-tax-label">Tax</div>
              <div class="spacer"></div>
              <div class="value"><span class="curr">$</span><span class="amt" id="v-tax">0.00</span></div>
            </div>

            <div class="row" id="fees-row">
              <div class="label">Additional Fees</div>
              <div class="spacer"></div>
              <div class="value"><span class="curr">$</span><span class="amt" id="v-fees">0.00</span></div>
            </div>

            <div class="row total">
              <div class="label">Total</div>
              <div class="spacer"></div>
              <div class="value"><span class="curr">$</span><span class="amt" id="v-total">0.00</span></div>
            </div>
          </div>
        </section>

        <!-- Deposit -->
        <section class="card avoid-break">
          <h3>Deposit</h3>
          <div class="deposit-row">
            <div class="deposit-label">Deposit Due</div>
            <div class="deposit-value" id="v-deposit">$0.00</div>
          </div>
        </section>

        <!-- Terms -->
        <section class="card avoid-break" id="terms-card">
          <h3>Payment &amp; Terms</h3>
          <div class="pre" id="v-terms"></div>
        </section>

        <!-- Notes -->
        <section class="card avoid-break" id="notes-card">
          <h3>Notes &amp; Exclusions</h3>
          <div class="pre" id="v-notes"></div>
        </section>

        <!-- Signatures -->
        <section class="signatures avoid-break">
          <div class="sig-block">
            <div class="sig-line signature">
              <span>Client Signature</span>
              <img class="sig-image" id="v-client-signature-img" alt="Client signature" hidden />
            </div>

            <div class="sig-inline two">
              <div class="sig-line">
                <span>Printed Name</span>
                <div class="sig-value" id="v-client-name"></div>
              </div>
              <div class="sig-line">
                <span>Date</span>
                <div class="sig-value" id="v-client-date"></div>
              </div>
            </div>
          </div>

          <div class="sig-block">
            <div class="sig-line signature">
              <span>Representative Signature</span>
              <div class="sig-signature" id="v-rep-signature"></div>
            </div>

            <div class="sig-inline two">
              <div class="sig-line">
                <span>Printed Name</span>
                <div class="sig-value" id="v-rep-printed-name"></div>
              </div>
              <div class="sig-line">
                <span>Date</span>
                <div class="sig-value" id="v-rep-date"></div>
              </div>
            </div>
          </div>
        </section>
      </section>

      <!-- Acceptance (screen only) -->
      <section id="accept-section" class="accept-card no-print" hidden>
        <div class="accept-head">
          <h2>Accept &amp; Sign</h2>
          <div class="pill" id="accept-pill">Ready</div>
        </div>

        <p class="accept-help">
          When you're ready, tap <strong>Sign Now</strong> and draw your signature.
          This confirms acceptance of the items, pricing, and terms in this quote.
        </p>

        <button id="sign-now-btn" class="btn brand wide" type="button">Sign Now</button>

        <p class="accept-foot">You can download a PDF copy at any time.</p>
      </section>
    </main>

    <!-- Signature modal (screen only) -->
    <div id="sig-modal" class="modal-overlay no-print" hidden>
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="sig-title">
        <div class="modal-head">
          <div class="modal-title" id="sig-title">Draw your signature</div>
          <button id="sig-close" class="icon-btn" type="button" aria-label="Close">✕</button>
        </div>

        <div class="modal-sub">Signing as <strong id="sig-name">Client</strong></div>

        <div class="sig-pad">
          <canvas id="sig-canvas" aria-label="Signature pad"></canvas>
        </div>

        <div class="modal-actions">
          <button id="sig-clear" class="btn" type="button">Clear</button>
          <button id="sig-submit" class="btn brand" type="button">Sign &amp; Accept</button>
        </div>

        <div class="modal-note">By signing, you accept this quote.</div>
      </div>
    </div>

    <script type="module" src="./quote.js"></script>
  </body>
</html>
